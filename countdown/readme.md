Code based on http://www.cs.nott.ac.uk/~pszgmh/ch9.pdf

